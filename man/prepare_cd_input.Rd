% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_residuals.R
\name{prepare_cd_input}
\alias{prepare_cd_input}
\title{Prepare residuals for CD / CD* tests}
\usage{
prepare_cd_input(
  E,
  standardize = c("row", "none"),
  demean_time = TRUE,
  min_per_time = 2L
)
}
\arguments{
\item{E}{A numeric matrix of residuals (\eqn{N \times T}); rows are units,
columns are time; may be unbalanced (contain \code{NA}).}

\item{standardize}{One of \code{"row"}, \code{"none"}.
If \code{"row"}, scale each row by its observed standard deviation.}

\item{demean_time}{Logical; if \code{TRUE}, subtract the cross-sectional mean at
each time from available residuals in that column.}

\item{min_per_time}{Integer; drop time columns with fewer than this many finite
observations.}
}
\value{
A list with:
\item{Z}{Processed residual matrix (\eqn{N \times T^*}) after filtering/standardizing/demeaning.}
\item{kept_t}{Integer indices of kept time columns (relative to the original \code{E}).}
\item{m_t}{Integer vector of cross-sectional counts per kept time (number of finite rows).}
\item{row_sds}{Numeric vector of row standard deviations used (invisibly \code{NA} if \code{standardize="none"}).}
\item{col_means}{Numeric vector of time means subtracted when \code{demean_time=TRUE}.}
}
\description{
Cleans and transforms an \eqn{N \times T} residual matrix for cross-sectional
dependence testing. Operations include:
\enumerate{
\item Dropping time periods with fewer than \code{min_per_time} finite observations.
\item Optional row-wise standardization to unit variance over available times.
\item Optional demeaning across units at each time (recommended for CD).
}
}
\keyword{internal}
