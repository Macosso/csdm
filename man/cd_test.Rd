% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_residuals.R
\name{cd_test}
\alias{cd_test}
\title{Cross-sectional dependence (CD) tests for panel data}
\usage{
cd_test(
  object,
  type = c("CD", "CDw", "CDw+", "CDstar", "all"),
  n_pc = 4,
  seed = 101
)
}
\arguments{
\item{object}{A csdm_fit model or an N x T residuals matrix (units × time).}

\item{type}{Which test(s) to compute: one or more of c("CD", "CDw", "CDw+", "CDstar", "all")}

\item{n_pc}{Number of principal components for CD* (default 4, matches Stata).}

\item{seed}{Integer. Seed for weight draws in CDw/CDw+ (default 101).}
}
\value{
Named list with statistics and p-values for selected tests.
}
\description{
Computes multiple cross-sectional dependence tests for panel residuals:
CD (Pesaran 2015), CDw (Juodis & Reese 2021), CDw+ (Fan et al. 2015), the
unstandardised CDw+ statistic used by Stata (`CDw_plus`), and
CD* (Pesaran & Xie 2021) with optional PCA-based factor adjustment.
}
\details{
Cross-sectional dependence tests (CD, CDw, CDw+, CD*) for panel residuals or model fits

Computes CD, weighted-CD, power-enhanced CDw+, or bias-corrected CD* statistics—as in Stata xtcd2.


**CD (Pesaran 2015, 2021):** Classic test using pairwise correlations of residuals.
  Statistic: \eqn{CD = \sqrt{2/(N(N-1))} \sum_{i<j} \sqrt{T_{ij}} \rho_{ij}}

**CDw (Juodis & Reese 2021):** Weighted CD after removing cross-sectional means from each time period.
  Controls for common shocks/factors.

**CDw+ (Fan et al. 2015, extended by Juodis & Reese 2021):** Enhanced CDw that ignores small correlations.
  Uses threshold c_N = sqrt(2*log(N)/T) for sparse dependence detection.

**CDw_plus_raw:** Stata-style version of CDw+ that reports the raw power–enhanced
statistic without normalising by \eqn{\sqrt{2/(N(N-1))}}.  This statistic
multiplies the Juodis–Reese CDw component by \eqn{\sqrt{N}} and adds the
sum of \eqn{\sqrt{T_{ij}} |\rho_{ij}|} over pairs exceeding the threshold \eqn{c_N}.
Because it is unstandardised, it can be very large and its sampling
distribution under the null is not standard normal; p-values are therefore
not reported.  Use this option only to reproduce Stata's `xtcd2` output.

**CD* (Pesaran & Xie 2021):** Bias-corrected test with PCA-based factor detrending.
  Removes first n_pc principal components from residuals, then applies CD.
  Default n_pc=4 matches Stata xtcd2 implementation.
}
\examples{
# Simulate independent and dependent panels
set.seed(1)
E_indep <- matrix(rnorm(100), nrow = 10)
E_dep <- matrix(rnorm(10), nrow = 10, ncol = 10, byrow = TRUE)

# Compute all four tests
cd_test(E_indep, type = "all")
cd_test(E_dep, type = "all")

# CD* with custom number of PCs
cd_test(E_indep, type = "CDstar", n_pc = 2)

}
\references{
Pesaran, M.H. (2015). "Testing weak cross-sectional dependence in large panels."
  Econometric Reviews, 34(6-10), 1089-1117.

Juodis, A., & Reese, S. (2021). "The incidental parameters problem in testing for
  remaining cross-sectional correlation." Journal of Business & Economic Statistics.

Fan, J., Liao, Y., & Yao, J. (2015). "Power Enhancement in High-Dimensional
  Cross-Sectional Tests." Econometric Reviews, 34(6-10), 742-779.

Pesaran, M.H., & Xie, Y. (2021). "A bias-corrected CD test for error cross-sectional
  dependence in panel models." Econometric Reviews, 41(6), 649-677.
}
