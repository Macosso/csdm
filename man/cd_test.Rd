% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_cd.R
\name{cd_test}
\alias{cd_test}
\alias{cd_test.default}
\alias{cd_test.csdm_fit}
\alias{print.cd_test}
\title{Cross-sectional dependence (CD) tests for panel data}
\usage{
cd_test(object, ...)

\method{cd_test}{default}(
  object,
  type = c("CD", "CDw", "CDw+", "CDstar", "all"),
  n_pc = 4L,
  seed = NULL,
  min_overlap = 2L,
  na.action = c("drop.incomplete.times", "pairwise"),
  ...
)

\method{cd_test}{csdm_fit}(
  object,
  type = c("CD", "CDw", "CDw+", "CDstar", "all"),
  n_pc = 4L,
  seed = NULL,
  min_overlap = 2L,
  na.action = c("drop.incomplete.times", "pairwise"),
  ...
)

\method{print}{cd_test}(x, digits = 3, ...)
}
\arguments{
\item{object}{A \code{csdm_fit} model object or a numeric matrix of residuals (N x T).}

\item{...}{Additional arguments passed to methods.}

\item{type}{Which test(s) to compute: one of \code{"CD"}, \code{"CDw"}, \code{"CDw+"},
\code{"CDstar"}, or \code{"all"} (default: \code{"CD"}).}

\item{n_pc}{Number of principal components for CD* (default 4).}

\item{seed}{Integer seed for weight draws in CDw/CDw+ (default NULL = no seed set).}

\item{min_overlap}{Minimum number of overlapping time periods required for a unit
pair to be included in CD/CDw/CDw+ (default 2).}

\item{na.action}{How to handle missing data: \code{"drop.incomplete.times"} (default)
removes time periods with any missing observations to create a balanced panel for CD*;
\code{"pairwise"} uses pairwise correlations for CD/CDw/CDw+ and warns for CD*.}

\item{x}{An object of class \code{cd_test}.}

\item{digits}{Number of digits to print (default 3).}
}
\value{
An object of class \code{cd_test} with a \code{tests} list.
  Each test returns a sublist with:
  \item{statistic}{Test statistic value}
  \item{p.value}{Two-sided p-value under standard normal null}
}
\description{
Computes cross-sectional dependence tests for panel residuals: CD (Pesaran 2015),
CDw (Juodis & Reese 2021), CDw+ (Fan et al. 2015), and CD* (Pesaran & Xie 2021)
with PCA-based factor adjustment.
}
\details{
\strong{Handling of missing data:}
\itemize{
  \item \strong{CD, CDw, CDw+:} Always use pairwise-complete observations. Each pair (i,j)
    correlation is computed over time periods where both units have finite residuals.
  \item \strong{CD*:} By default (\code{na.action = "drop.incomplete.times"}), automatically
    removes time periods with any missing observations to create a balanced panel and
    applies CD*. With \code{na.action = "pairwise"}, requires a balanced panel and
    returns \code{NA} with a warning if NAs are present.
}

When \code{na.action = "drop.incomplete.times"}, the function reports how many time periods
were dropped and the dimensions of the resulting balanced panel.

\strong{Test descriptions:}
\itemize{
  \item \strong{CD (Pesaran 2015, 2021):} Classic test using pairwise correlations.
    Statistic: \eqn{CD = \sqrt{2/(N(N-1))} \sum_{i<j} \sqrt{T_{ij}} \rho_{ij}}.
  \item \strong{CDw (Juodis & Reese 2021):} Weighted CD with random sign flips,
    controlling for common shocks/factors.
  \item \strong{CDw+ (Fan et al. 2015):} Power-enhanced CDw using sparse thresholding.
    Threshold: \eqn{c_N = \sqrt{2 \log(N)/T}}.
  \item \strong{CD* (Pesaran & Xie 2021):} Bias-corrected CD after removing
    \code{n_pc} principal components via PCA (default 4, matching Stata xtcd2).
}
}
\examples{
# Simulate independent and dependent panels
set.seed(1)
E_indep <- matrix(rnorm(100), nrow = 10)
E_dep <- matrix(rnorm(10), nrow = 10, ncol = 10, byrow = TRUE)

# Compute all tests
cd_test(E_indep, type = "all")
cd_test(E_dep, type = "all")

# Specific test with parameters
cd_test(E_indep, type = "CDstar", n_pc = 2)

}
\references{
Pesaran, M.H. (2015). "Testing weak cross-sectional dependence in large panels."
  \emph{Econometric Reviews}, 34(6-10), 1089-1117.

Juodis, A., & Reese, S. (2021). "The incidental parameters problem in testing for
  remaining cross-sectional correlation." \emph{Journal of Business & Economic Statistics}.

Fan, J., Liao, Y., & Yao, J. (2015). "Power Enhancement in High-Dimensional
  Cross-Sectional Tests." \emph{Econometric Reviews}, 34(6-10), 742-779.

Pesaran, M.H., & Xie, Y. (2021). "A bias-corrected CD test for error cross-sectional
  dependence in panel models." \emph{Econometric Reviews}, 41(6), 649-677.
}
