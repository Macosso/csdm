% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_residuals.R
\name{cd_test}
\alias{cd_test}
\title{Cross-sectional dependence (CD) tests for panel data}
\usage{
cd_test(
  object,
  type = c("CD", "CDw", "CDw+", "CDstar", "all"),
  n_pc = 4L,
  res_type = c("auto", "pca_std", "pca", "cce"),
  min_overlap = 2L
)
}
\arguments{
\item{object}{A fitted model object (e.g., class `csdm_fit`) or a numeric N x T matrix of residuals.}

\item{type}{Which CD test(s) to compute: one of `"CD"` (default), `"CDw"`, `"CDw+"`, `"CDstar"`, or `"all"`.}

\item{n_pc}{Number of principal components to remove for CD* test (default 4, matching Stata xtcd2).}

\item{res_type}{Residual type to extract from model objects (see [get_residuals()]).}

\item{min_overlap}{Minimum number of overlapping time periods for a unit pair to be included.}
}
\value{
A list with test results. If type is a single test, returns list with `statistic`, `p.value`, `N`, `pairs_used`.
  If type="all", returns list with elements for each test (`CD`, `CDw`, `CDw_plus`, `CDstar`).
}
\description{
Computes multiple cross-sectional dependence tests for panel residuals:
CD (Pesaran 2015), CDw (Juodis & Reese 2021), CDw+ (Fan et al. 2015), and
CD* (Pesaran & Xie 2021) with optional PCA-based factor adjustment.
}
\details{
**CD (Pesaran 2015, 2021):** Classic test using pairwise correlations of residuals.
  Statistic: \eqn{CD = \sqrt{2/(N(N-1))} \sum_{i<j} \sqrt{T_{ij}} \rho_{ij}}

**CDw (Juodis & Reese 2021):** Weighted CD after removing cross-sectional means from each time period.
  Controls for common shocks/factors.

**CDw+ (Fan et al. 2015, extended by Juodis & Reese 2021):** Enhanced CDw that ignores small correlations.
  Uses threshold c_N = sqrt(2*log(N)/T) for sparse dependence detection.

**CD* (Pesaran & Xie 2021):** Bias-corrected test with PCA-based factor detrending.
  Removes first n_pc principal components from residuals, then applies CD.
  Default n_pc=4 matches Stata xtcd2 implementation.
}
\examples{
# Simulate independent and dependent panels
set.seed(1)
E_indep <- matrix(rnorm(100), nrow = 10)
E_dep <- matrix(rnorm(10), nrow = 10, ncol = 10, byrow = TRUE)

# Compute all four tests
cd_test(E_indep, type = "all")
cd_test(E_dep, type = "all")

# CD* with custom number of PCs
cd_test(E_indep, type = "CDstar", n_pc = 2)

}
\references{
Pesaran, M.H. (2015). "Testing weak cross-sectional dependence in large panels."
  Econometric Reviews, 34(6-10), 1089-1117.

Juodis, A., & Reese, S. (2021). "The incidental parameters problem in testing for
  remaining cross-sectional correlation." Journal of Business & Economic Statistics.

Fan, J., Liao, Y., & Yao, J. (2015). "Power Enhancement in High-Dimensional
  Cross-Sectional Tests." Econometric Reviews, 34(6-10), 742-779.

Pesaran, M.H., & Xie, Y. (2021). "A bias-corrected CD test for error cross-sectional
  dependence in panel models." Econometric Reviews, 41(6), 649-677.
}
