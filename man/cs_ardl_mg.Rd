% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cs_ardl_mg.R
\name{cs_ardl_mg}
\alias{cs_ardl_mg}
\title{Cross-Sectionally Augmented ARDL (CS-ARDL) Mean Group Estimator}
\usage{
cs_ardl_mg(
  formula,
  data,
  id,
  time,
  p = 1,
  q = 1,
  P = 1,
  loo = TRUE,
  trend = FALSE,
  robust_se = c("none", "HC1", "HC3"),
  min_T = 10
)
}
\arguments{
\item{formula}{An object like `y ~ x1 + x2 + ...`. All regressors on RHS are treated as levels
for ARDL construction; lags are generated internally.}

\item{data}{A data.frame (or tibble) with columns for `id`, `time`, `y`, `x`'s.}

\item{id, time}{Column names (strings) identifying unit and time indices.}

\item{p}{Integer \(\ge 1\). Number of lags of \(y\).}

\item{q}{Integer (recycled) or named integer vector for lags of each regressor
(names must match RHS variable names). `q` counts max lag; lag 0 is included by default.}

\item{P}{Integer \(\ge 0\). Number of lags of cross-sectional averages added (lag 0..P).}

\item{loo}{Logical. If `TRUE`, compute CSAs in leave-one-out fashion.}

\item{trend}{Logical. If `TRUE`, adds a deterministic linear trend (common slope) to each unit regression.}

\item{robust_se}{One of `c("none","HC1","HC3")` for unit OLS variance; MG SEs are based on cross-sectional dispersion of unit estimates.}

\item{min_T}{Integer. Minimum time observations required per unit after lagging; units with fewer are dropped.}
}
\value{
A list with MG estimates, their SEs, CD test, and unit-level results (see Details).
}
\description{
Estimates unit-specific ARDL(p, q) regressions augmented with cross-sectional
averages (CSAs) of the dependent variable and regressors—plus their lags up to `P`—
then averages the coefficients across units (Mean Group). The CSA terms proxy
latent common factors and mitigate cross-sectional dependence.
}
\details{
**Model.** For unit \(i=1,\dots,N\) and time \(t\), let \(y_{it}\) be the dependent
variable and \(x_{it}\) a K-vector of regressors. A CS-ARDL(p, q, P) for unit \(i\) is
\deqn{
y_{it} = \alpha_i + \sum_{j=1}^{p} \phi_{ij} y_{i,t-j}
         + \sum_{k=1}^{K} \sum_{s=0}^{q_k} \beta_{ik,s} x_{k,i,t-s}
         + \sum_{\ell=0}^{P} \delta_{i\ell}^{(y)} \bar{y}_{t-\ell}
         + \sum_{k=1}^{K} \sum_{\ell=0}^{P} \delta_{ik,\ell}^{(x)} \bar{x}_{k,t-\ell}
         + u_{it},
}
where \(\bar{y}_t\) and \(\bar{x}_{k,t}\) are cross-sectional averages (CSAs) that can be
computed either **including** or **excluding** unit \(i\) (leave-one-out, `loo=TRUE`).

**Long-run effects.** For each unit \(i\), the long-run coefficient on regressor \(k\) is
\(\theta_{ik} = \big(\sum_{s=0}^{q_k} \beta_{ik,s}\big) / \big(1 - \sum_{j=1}^{p} \phi_{ij}\big)\),
provided the AR polynomial is stable. The function reports MG means of \(\theta_{ik}\) and
their MG standard errors (cross-sectional dispersion / \(\sqrt{N}\)).

**Unbalanced panels.** Estimation drops rows with insufficient lags; CSAs at time \(t\)
are computed using all units with non-missing values at \(t\) (and excluding \(i\) if `loo=TRUE`).

**Returns.**
- `coef_mg_short`: MG averages of the unit-level **short-run** coefficients (on the lagged \(y\) and lagged \(x\)'s).
- `coef_mg_long`: MG averages of **long-run** coefficients \(\theta_k\) with MG SEs.
- `phi_mg`: MG average of the sum of lagged-\(y\) coefficients \(\sum_j \phi_{ij}\) and its SE.
- `r2_mg`: average of unit-level R² from each OLS.
- `cd_stat`, `cd_pval`: Pesaran-style CD test on pooled residuals.
- `units`: tibble with unit-level results (coefficients, long-run, R², residuals index).

**Related literature in your PDFs.**
- MG/PMG background and ARDL motivation: Pesaran & Smith (1995); Pesaran, Shin & Smith (1999).
- CS augmentation to address unobserved common factors: see the dynamic CCE/CS-ARDL approach
  developed by Chudik & Pesaran (2015).
- Error-correction and panel cointegration testing context: Westerlund (2007).

This implementation is aligned with those ideas but written from scratch for the package.
}
