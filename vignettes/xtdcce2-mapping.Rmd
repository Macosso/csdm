---
title: "Replicating xtdcce2 specifications in csdm"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Replicating xtdcce2 specifications in csdm}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  message = FALSE,
  warning = FALSE
)
```

## Overview

`csdm` provides Mean Group (MG), Common Correlated Effects (CCE), and Dynamic CCE (DCCE) estimators via `csdm()`.

This vignette provides a **conceptual mapping** from common `xtdcce2` (Stata) specification concepts to runnable R usage with `csdm`. It does **not** claim numerical equivalence.

## Quick mapping

| Stata concept / xtdcce2 option (descriptive) | `csdm` syntax |
|---|---|
| Dynamic dependent-variable lag (e.g., `L.y`) | `lr = csdm_lr(type="ardl", ylags=1)` |
| Cross-sectional averages controls | `csa = csdm_csa(vars=c(...), lags=...)` |
| CSA lags (e.g., 3) | `csa = csdm_csa(..., lags=3)` |
| Scalar distributed lags for all RHS regressors | `lr = csdm_lr(type="ardl", xdlags=K)` |
| Pesaran CD test | `cd_test(fit)` |

## Worked example with `PWT_60_07`

```{r}
library(csdm)
data(PWT_60_07, package = "csdm")
df <- PWT_60_07

fit <- csdm(
  log_rgdpo ~ log_hc + log_ck + log_ngd,
  data = df,
  id = "id",
  time = "year",
  model = "dcce",
  csa = csdm_csa(
    vars = c("log_rgdpo", "log_hc", "log_ck", "log_ngd"),
    lags = 3
  ),
  lr = csdm_lr(type = "ardl", ylags = 1)
)

summary(fit)
cd_test(fit)
```

```{r}
fit_dx <- csdm(
  log_rgdpo ~ log_hc + log_ck + log_ngd,
  data = df,
  id = "id",
  time = "year",
  model = "dcce",
  csa = csdm_csa(
    vars = c("log_rgdpo", "log_hc", "log_ck", "log_ngd"),
    lags = 3
  ),
  lr = csdm_lr(type = "ardl", ylags = 1, xdlags = 1)
)

names(coef(fit_dx))
```

## Notes on formula support

- `xdlags` currently supports only **simple RHS variable names** (no transformations or interactions like `log(x)` or `x1:x2`).
- Generated lag columns follow the naming convention `lag1_<varname>`, `lag2_<varname>`, ...
